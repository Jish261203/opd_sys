{% extends 'base.html' %} {% block title %}Create Appointment - OPD System{%
endblock %} {% block content %}
<div class="row">
  <div class="col-md-8 offset-md-2">
    <h2>Book New Appointment</h2>

    <div class="card mt-4">
      <div class="card-body">
        <form method="POST" action="/appointments/create">
          <div class="mb-3">
            <label for="patient_id" class="form-label">Select Patient *</label>
            <select
              class="form-control"
              id="patient_id"
              name="patient_id"
              required
            >
              <option value="">-- Select a Patient --</option>
              {% for patient in patients %}
              <option value="{{ patient.id }}">
                {{ patient.name }} ({{ patient.phone }})
              </option>
              {% endfor %}
            </select>
            <small class="form-text text-muted"
              >Only active patients are shown</small
            >
          </div>

          <div class="mb-3">
            <label for="doctor_name" class="form-label">Doctor Name *</label>
            <input
              type="text"
              class="form-control"
              id="doctor_name"
              name="doctor_name"
              required
              placeholder="Enter doctor's name"
            />
          </div>

          <div class="mb-3">
            <label for="appointment_datetime" class="form-label"
              >Appointment Date & Time *</label
            >
            <input
              type="datetime-local"
              class="form-control"
              id="appointment_datetime"
              name="appointment_datetime"
              required
            />
            <small class="form-text text-muted">Must be in the future</small>
          </div>

          <div class="d-grid gap-2 d-md-flex justify-content-md-end">
            <a href="/appointments/today" class="btn btn-secondary">Cancel</a>
            <button type="submit" class="btn btn-success">
              Book Appointment
            </button>
          </div>
        </form>
      </div>
    </div>

    <div class="alert alert-info mt-4">
      <strong>Note:</strong> Appointments can only be created for
      <strong>Active</strong> patients and must be scheduled for a future
      date/time.
    </div>
  </div>
</div>

<script>
  // Set minimum date to now
  document.getElementById("appointment_datetime").min = new Date()
    .toISOString()
    .slice(0, 16);
</script>
{% endblock %}
